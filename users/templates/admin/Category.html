{% extends 'admin/dashboard.html' %}
{% load static%}
{% load bootstrap_icons %}

{% block sidebar %}

  <li>
    <a class="collapsible-header waves-effect arrow-r">
      <i class="w-fa fas fa-tachometer-alt"></i>Categori<i class="fas fa-angle-down rotate-icon"></i>
    </a>
    <div class="collapsible-body">
      <ul>
        {% for category in categorys %}
          <li>
            <a href="#{{ category.slug }}" class="waves-effect">{{ category.title }}</a>
          </li>
        {%  endfor %}
      </ul>
    </div>
  </li>

  <li>
    <a class="collapsible-header waves-effect arrow-r">
      <i class="w-fa fas fa-tachometer-alt"></i>Lectii<i class="fas fa-angle-down rotate-icon"></i>
    </a>
    <div class="collapsible-body">
        {% for category in categorys %}
          <ul class="collapsible collapsible-accordion m-0 border-bottom">
            <li>
              <a class="collapsible-header waves-effect arrow-r">
                {{ category.title }}<i class="fas fa-angle-down rotate-icon"></i>
              </a>
              <div class="collapsible-body">
                <ul>
                  {% for lectii in category.lessons.all %}
                  <li>
                    <a href="#{{ lectii.slug }}" class="waves-effect">{{ lectii.title }}</a>
                  </li>
                  {% endfor %}
                </ul>
              </div>
            </li>
          </ul>
        {%  endfor %}
    </div>
  </li>
  
{% endblock %}

{% block content %}
<!-- Category Form -->
  <div class="modal fade right modal-scrolling" id="modalCategoryForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="false" style="display: none;" aria-hidden="true">
    <div class="modal-dialog modal-side modal-top-right modal-notify modal-primary" role="document">
      <!-- Content -->
      <div class="modal-content">
        <!-- Header -->
        <div class="modal-header">
          <p class="heading lead">Adaugare Categorie</p>

          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="white-text">×</span>
          </button>
        </div>

        <!-- Body -->
        <form method="post">
          <div class="modal-body">
            <div class="text-center">
                {% csrf_token %}
                <div class="md-form ml-5 mr-5">
                  <label for="id_title">Titlu</label>
                  {{ categoryForm.title }}
                </div>
            </div>
          </div>

          <!-- Footer -->
          <div class="modal-footer justify-content-center">
            <button type="submit" class="btn-sm btn-outline-primary rounded-pill px-2 py-0">Save</button>
          </div>
        </div>
      </form>
      <!-- Content -->
    </div>
  </div>

    {% for category in categorys %}
        <!-- Card -->
        <div class="card card-cascade narrower" style="min-width: 900px;">
  
            <!-- Section: Table -->
            <section>

              <div class="card card-cascade narrower z-depth-0">
  
                <div class="view view-cascade gradient-card-header blue-gradient narrower p-3  d-flex justify-content-between align-items-center">
                  <style>
                    #{{ category.slug }}:target{
                      border-bottom: 1px solid white;
                    }
                  </style>
                  <a id="{{ category.slug }}" href="{% url 'lessons:lessons_category' lesson_slug=category.slug %}" class="white-text mx-3 px-4">{{ category.title }}</a>

                </div>
  
                <div class="px-4">
  
                  <div class="table-responsive">
  
                    <!--Table-->
                    <table class="table table-hover mb-0 text-center">
  
                      <!-- Table head -->
                      <thead>
                        <tr>
                            <th class="th-lg">Lectie</th>
                            <th class="th-lg">Content</th>
                            <th class="th-lg">Exerciti</th>
                        </tr>
                      </thead>
                      <!-- Table head -->
  
                      <!-- Table body -->
                      <tbody>
                          {% for lectii in category.lessons.all %}
                            <tr>
                                <td class="d-flex justify-content-between">
                                  <style>
                                    #{{ lectii.slug }}:target{
                                      border-bottom: 1px solid black;
                                    }
                                  </style>
                                    <a id="{{ lectii.slug }}" href="{% url 'staff:editlessons' id=lectii.id %}">Lectia {{ lectii }}</a>
                                    <div class="d-flex">
                                      <a class="mr-2 ml-2" href="{{ lectii.get_absolute_url }}">{% bs_icon 'eye' %}</a>
                                      <form action="{% url 'staff:deletelessons' id=lectii.id %}" method="post">
                                        {% csrf_token %}
                                        <button class="text-black" type="submit" style="border:none;background-color: inherit;">{% bs_icon 'trash' %}</button>
                                      </form>
                                    </div>
                                </td>
                                <td>
                                  <div style="max-height:400px ;overflow-y:auto ;">
                                    {% for lectie in lectii.lesson.all %}
                                        <div class="d-flex justify-content-between" >
                                          {% if lectie.title %}
                                            <a class="mr-1" href="{% url 'staff:editlesson' id=lectie.id %}">ID numarul  content <b>{{lectie}}</b></a> 
                                          {% else %}
                                            <a class="mr-1" href="{% url 'staff:editlesson' id=lectie.id %}">ID numarul  content <b>{{lectie.id }}</b></a> 
                                          {% endif %}
                                            <form action="{% url 'staff:deletelesson' id=lectie.id %}" method="post">
                                              {% csrf_token %}
                                              <button class="text-black" type="submit" style="border:none;background-color: inherit;">{% bs_icon 'trash' %}</button>
                                            </form>
                                        </div>
                                    {% endfor %}
                                  </div>
                                    
                                    <!-- Lesson form -->
                                    <div class="modal fade" id="modalLesson{{ lectii.slug }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="display: none;" aria-hidden="true">
                                      <div class="modal-dialog modal-lg modal-notify modal-primary" role="document">
                                        <!-- Content -->
                                        <div class="modal-content">
                                          <!-- Header -->
                                          <div class="modal-header">
                                            <p class="heading lead">Adaugare Content</p>
                            
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                              <span aria-hidden="true" class="white-text">×</span>
                                            </button>
                                          </div>
                            
                                          <!-- Body -->
                                          <form action="{% url 'staff:addlesson' lessons_id=lectii.id %}" method="post">
                                          <div class="modal-body">
                                            <div class="text-center">
                                              {% csrf_token %}
                                              <div class="md-form">
                                                <label for="id_title">Titlu</label>
                                                {{ lessonForm.title }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_content">Content</label>
                                                {{ lessonForm.content }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_code_python">Cod Python</label>
                                                {{ lessonForm.code_python }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_code_html">Cod HTML</label>
                                                {{ lessonForm.code_html }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_code_css">Cod CSS</label>
                                                {{ lessonForm.code_css }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_code_js">Cod JavaScript</label>
                                                {{ lessonForm.code_js }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_video">Linkul Videoclipului</label>
                                                {{ lessonForm.code_link }}
                                              </div>
                                              </div>
                                            </div>
                                            <!-- Footer -->
                                            <div class="modal-footer">
                                              <button type="submit" class="btn btn-outline-primary rounded-pill px-2 py-0">Save</button>
                                            </div>
                                          </div>
                                        </div>
                                      </form>
                                    </div>
                                    <button type="button" class="btn-sm btn-outline-primary rounded-pill px-2 py-0" data-toggle="modal" data-target="#modalLesson{{ lectii.slug }}" data-backdrop="false">{% bs_icon 'plus' %} Content</button>
                                </td>
                                <td>
                                  <div style="max-height:400px ;overflow-y:auto ;">
                                    {% for exercitiu in lectii.exercise.all %}
                                    <div class="d-flex justify-content-between">
                                      <a href="{% url 'staff:editexercise' id=exercitiu.id %}">{{exercitiu.title}}</a> 
                                      <div class="d-flex">
                                        <a class="mr-2 ml-2" href="{{ exercitiu.get_absolute_url }}">{% bs_icon 'eye' %}</a> 
                                        <form action="{% url 'staff:deleteexercise' id=exercitiu.id %}" method="post">
                                          {% csrf_token %}
                                          <button class="text-black" type="submit" style="border:none;background-color: inherit;">{% bs_icon 'trash' %}</button>
                                        </form>
                                      </div>
                                    </div>
                                    {% endfor %}
                                  </div>
                                    <!-- Exercise form -->
                                    <div class="modal fade" id="modalExercise{{ lectii.slug }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="display: none;" aria-hidden="true">
                                      <div class="modal-dialog modal-lg modal-notify modal-primary" role="document">
                                        <!-- Content -->
                                        <div class="modal-content">
                                          <!-- Header -->
                                          <div class="modal-header">
                                            <p class="heading lead">Adaugare Content</p>
                            
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                              <span aria-hidden="true" class="white-text">×</span>
                                            </button>
                                          </div>
                            
                                          <!-- Body -->
                                          <form action="{% url 'staff:addexercise' lessons_id=lectii.id %}" method="post">
                                          <div class="modal-body">
                                            <div class="text-center">
                                              {% csrf_token %}
                                              <div class="md-form">
                                                <label for="id_title">Titlu</label>
                                                {{ exerciseForm.title }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_description">Descriere</label>
                                                {{ exerciseForm.description }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_exercise">Exercitiu</label>
                                                {{ exerciseForm.exercise }}
                                              </div>
                                              <div class="md-form">
                                                <label for="id_help">Help</label>
                                                {{ exerciseForm.help }}
                                              </div>
                                              </div>
                                            </div>
                                            <!-- Footer -->
                                            <div class="modal-footer">
                                              <button type="submit" class="btn btn-outline-primary rounded-pill px-2 py-0">Save</button>
                                            </div>
                                          </div>
                                        </div>
                                      </form>
                                    </div>
                                    <button type="button" class="btn-sm btn-outline-primary rounded-pill px-2 py-0" data-toggle="modal" data-target="#modalExercise{{ lectii.slug }}" data-backdrop="false">{% bs_icon 'plus' %} Exercitiu</button>
                                </td>
                            </tr>
                          {% endfor %}
                        
                      </tbody>
                      <!-- Table body -->
  
                    </table>
                    <!-- Table -->
  
                  </div>
  
                  <hr class="my-0">
  
                  <!-- Bottom Table UI -->
                  <div class="d-flex justify-content-end">
                    <div class="row my-4">
                      <div class="mr-1">
                        <button class="btn-sm btn-outline-primary rounded-pill px-2 py-0" data-toggle="modal" data-target="#modalLessons{{ category.slug }}" data-backdrop="false">{% bs_icon 'plus' %} Lectie</button>
                      </div>
                      
                      <form action="{% url 'staff:deleteCategory' id=category.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="btn-sm btn-outline-danger rounded-pill px-2 py-0">Delete</button>
                      </form>
                    </div>
                  </div>
                  <!-- Bottom Table UI -->
  
                </div>
  
              </div>
  
            </section>
            <!--Section: Table-->
  
          </div>
          <!-- Card -->
          <!-- Lessons Form -->
          <div class="modal fade right modal-scrolling" id="modalLessons{{ category.slug }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="false" style="display: none;" aria-hidden="true">
            <div class="modal-dialog modal-side modal-top-right modal-notify modal-primary" role="document">
              <!-- Content -->
              <div class="modal-content">
                <!-- Header -->
                <div class="modal-header">
                  <p class="heading lead">Adaugare Lectie</p>
        
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="white-text">×</span>
                  </button>
                </div>
        
                <!-- Body -->
                <form action="{% url 'staff:addlessons' category_id=category.id %}" method="post">
                  <div class="modal-body">
                    <div class="text-center">
                        {% csrf_token %}
                        <div class="md-form ml-5 mr-5">
                          <label for="id_title">Titlu</label>
                          {{ lessonsForm.title }}
                        </div>
                        <div class="md-form ml-5 mr-5">
                          <label for="id_content">Content</label>
                          {{ lessonsForm.content }}
                        </div>
                    </div>
                  </div>
        
                  <!-- Footer -->
                  <div class="modal-footer justify-content-center">
                    <button type="submit" class="btn btn-outline-primary rounded-pill px-2 py-0">Save</button>
                  </div>
                </div>
              </form>
              <!-- Content -->
            </div>
          </div>
    {% endfor %} 
 
    <div style="position: fixed;right: 25px;bottom: 50px;">
      <a class="btn btn-primary rounded-pill" data-toggle="modal" data-target="#modalCategoryForm" data-backdrop="false">{% bs_icon 'plus' %} Category</a> 
    </div> 
    
    {% if category %}
    
    {% endif %}
{% endblock%}